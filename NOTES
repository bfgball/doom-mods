## Roadmap

### Ideas for Laevis split-off

Three possible operating modes:
- Laevis; eat weapons to gain powers, eat higher ranked weapons to rank up and increase your power slots
- Bonsai level integration; respond to bonsai level-up messages by giving new upgrades
- Bonsai upgrade integration; add a set of bonsai upgrades corresponding to different LD upgrades? don't quite remember

### next

- disable particles option to help narrow down causes of heavy lag
- disable trails option for frag shots likewise
- submunitions can chain-trigger on enemies killed by dots; this is probably due to dot damage not properly setting the weaponspecial field
- swap thunderbolt and paralysis because para is wicked powerful?

-  nullpointer when attacking upgraded centaurs in Serpent Resurrection:
  - Called from TFLV_Upgrade_Thunderbolt_Aux.PostBeginPlay at GunBonsai-0.9.3.pk3:ca.ancilla.bonsai/upgrades/lightning.zsc, line 461

### 0.10.x?

- split laevis into its own mod

### Soon

- scavenge lead probabalistic below 100hp & for ammo that produces low amounts
  - something like: ammo count = (base ammo count * 0.1 * target health/100)
- Revivification rework:
  - raised enemies don't collide with player projectiles, if possible
- Shield upgrade rework
  - rather than a flat damage reduction, have it charge up when making kills in melee, and gradually fade when not doing so
- add ammo capacity upgrade
  - walk player inventory and boost the MaxAmount and BackpackMaxAmount
  - requires OnApply support, probably
  - won't affect ammo types the player doesn't have yet
  - will be a player mod, so it should either be fairly powerful or get more powerful with time
  - we can use GetDefaultByType(ammoitem).MaxAmount to compute the base max amount
    and then confer bonuses based on that
- Make melee detection more permissive, but only trigger melee upgrades when the player is in melee
- upgrade that spawns extra projectiles every N shots

### Ideas

### MsrSgtShooterPerson

Upgrade that adds random projectiles from any player weapon or monster in the game into your shots (either picked at random when you choose the upgrade or as you fire).

### DarkkOne suggests a shield rework

An idea for shield - can you tell how far away the monster that damaged you is?

Like, only apply shield to close-range damage? Maybe even scaling it up the closer they get (to a maximum) rather than just having a hard line where it does and doesn't apply?

Another option, if detecting incoming damage source range isn't possible, is change shield - instead of going 20, 40, 60, just have the first upgrade cap it at 50 (and honestly, maybe even reinstate 75 for this one). But each further upgrade of it increases a duration. When you hit an enemy with a "melee" attack (as defined by whatever the current detection method is at the time), you get 10 (or maybe 5) seconds of shield per rank, non-cumulative (so it refreshes up to 10/20/whatever on kill, but can't be stockpiled). So for shield to be useful you have to be very aggressive. You take full damage while closing (during which time you often have a bit more option in how to dodge) but once you're engaged, your goal is to keep landing hits, to keep yourself actively shielded until the fight is over.

Both of these also mean you can't just like... pull out your chainsaw to reduce damage from arachnotron turrets on the other side of a canyon or whatever.

### ideas from Netheritor



### Ideas from Shatter-Thought

Blood-Sourced replicated ammo: Enemies killed by this weapon have a 10% to put out ammo for the **** weapon (**** would be adjustable in the options so the player can choose a weapon that the effect helps to spit out ammo for.)

Psycho-Serum: Enemies hit by this weapon have a 1% chance per level to turn on their former allies for 20 seconds. Cannot affect enemy already effected by Argent Steroids (I thought 1 percent per level was the most balanced choice.)

Argent Steroids: On the first hit, a target is given an extra 35% health, and becomes 50 percent more aggressive (Just the one time for the first time damaged), upon dying, the enemy explodes violently, stacks with explosive death. Cannot affect enemy already affected with Psycho-Serum effect (The intention for this idea is a risk/reward effect to give a player a tougher target they can level up weapons on, but at the risk of a more dangerous opponent.)

### ideas from ferretmanjcdenton

X Making a bullet remote controlled (doom storm ,unreal and russian overkill use weapons like this ).
X A wall piercing bullet .
X An upgrade transforming the whole weapon in something else entirely maybe ? Or changing the ammunition from ballistic to energy ? No idea if that's possible .
X Upgrades like Red dot / holo sights maybe ? Sights in general ?
X Making a gun shoot turrets.

A bullet which lands on an enemies and exploded in 4 grenade like thingies which itself fly upwards only to. Come crashing down resulting in 4 more big explosions .

The resurrection bullet was mentioned twice .

The fragmentation shot could be upgraded in so many ways .
If there is a way to choose multiple upgrades for an upgrade would open even more possibilities . imagine an fragmentation shot with the homing ability applied to the fragmented bullets and that one can be upgraded to home in on heads ..

Making positiv and negative effects would be fun too .

For the main level upgrades . The whole skill tree from RPG lite or Ultimate custom doom could help there .
Skills like :Faster walking ,higher jumping ,better environmental resistance,looking through walls ,getting a radar ..and so on ..

### ideas from xubs

Trauma Kit: Player upgrade. Healing is now 25% more effective from all sources (minimum of 1 additional healing), however all healing except the additional 25% is applied slowly, with a healing rate of 3 (more per level) HP per second. [This upgrade would massively benefit things like Health Bonuses, effectively doubling their healing from 1 to 2 with basically no downside, but only mildly benefit things like Soul Spheres with the potential downside of forcing the player to play better and avoid damage for longer to maximize this upgrade's effectiveness.]
    ​
Center of Mass: Weapon upgrade. Standing still builds stacks of Focus. Firing or moving expends all stacks of Focus. Focus increases damage, with more stacks increasing damage further. Level increases the maximum amount of Focus stacks the player may obtain. [Basically just a sniper-style upgrade, benefiting weapons which do a lot of damage all at once.]

Spectral Inscription: On dealing damage with a weapon with this applied, the player will fire an additional spectral projectile from their eyes once every 35 tics (-2 tic per level). The projectile is summoned by player-attributed damage events rather than the player's attacking states. The spectral projectile inherits no properties from the weapon that fired it other than copying the damage from the damage instance that summon it. Intermediate and Mastery upgrades increase the projectile's speed and add homing capabilities. [The idea here is to provide a roundabout fire rate increase without actually modifying a weapon's states in any way and potentially breaking compatibility, since it's been suggested before and shot down.]
    ​
Resurrecting Inscription: This ability will resurrect the first enemy killed with a weapon that has it applied. The enemy will fight for the player until they die or until 8 seconds have passed (+2 seconds per level), in which case they are automatically killed. Enemies with more than 600 health, or who have the +FRIENDLY tag already applied, are exempt. Taking this on multiple weapons allows additional enemies to be resurrected, without having to switch to other weapons that have it applied. [The idea here is to provide a sort of 'summoner build' to be possible. The timer restriction is there to prevent a cascading windfall of summons, while the >600 health restriction is mainly just there to prevent anything as strong as or stronger than an Arch-Vile from being resurrected. Taking multiple copies of the inscription is there to encourage people to really build into it by sacrificing other inscription slots if they want summons to really be a major part of their playstyle, instead of handing players it for free.]
    ​
Crossfire: Weapons with this ability will do 30% extra damage for 3 seconds after it is switched to. Afterwards, it will do -15% damage. Mutually exclusive with the Damage upgrade. [To benefit the chronic weapon switchers out there, or especially weapon mods which contain reloading weapons.]

### ideas from retronutcase

First off, this is an absolutely solid mod. LOVE IT! There's definitely some things I think it could use, tweak wise, but that's just me, so take anything I say with a grain of salt, these are just my thoughts, I'm not gonna hound you over these ideas or anything.

-The fact things like Submunitions and Fragmentation can proc elemental effects from the get go makes them obscenely powerful for element purposes. I feel like they should require a rare weapon upgrade to be able to proc elemental effects.

-I am not 100% sure on this, but can Submunitions that kill an enemy trigger more submunitions? If so, this feels like it should also require a rare upgrade to actually allow for it. Something like "Chain Reaction: Allows death explosions and submunitions to trigger their effects on enemies they kill."

On another note, maybe to spice things up, offer upgrades that come with upsides and downsides? Some examples of what I mean:

-Superdense: Adds 50% more damage to projectile weapons, but also inflicts a 25% speed penalty in exchange per level.

-HP Ammo: Adds 50% more damage to hitscan weapons, but they now fire projectiles (They cannot gain projectile based upgrades however). Further upgrades increase weapon spread by 25% per level.

-Big Spender: The weapon gains 50% more damage, but its ammo cost is doubled. Both bonuses are doubled on future level ups: 100% more damage and 4x ammo cost, 200% more damage but 8x ammo cost, etc.

Also, I feel like we could use some more common type upgrades to balance out the really strong ones like Submunitions and Fragmentation. I admit, I dunno how feasible these would be for a universal system

-Reduced Spread: Reduces spread of hitscan weapons by 10% per level. Caps at level 5.

-Increased Fire Rate: Increase weapon rate of fire by 10% per level. I admit I dunno how easy this to implement with the universal upgrade style you're aiming for.

-Critical Hit: 10% chance to increase weapon damage by 50% when firing. Unlocks Critical Damage and Critical Chance upgrades which further improve these. Critical chance is +5% chance per level, caps at level 8. Critical Damage increases the damage bonus by 5% per level and caps at level 10.

-Critical Gamble: Reduces non critical damage by by 50%, but boosts Critical Chance by 5% per level, and Critical Damage by 10% per level. Caps at Level 5.

-Suppressor: Reduces weapon noise and distance per level. At level 5, the weapon becomes completely silent.

-Free Shot: 5% chance to not consume ammo per level, caps at level 10.

There's definitely potential for more variety in character upgrades too, I think:

-Better Healing: +1 Health from Health Bonuses, +5 Health from Stimpacks, +10 Health from Medkits per level. Caps at Level 5. Rare upgrade

-Charged Shots: When not firing, the damage of your next shot increases over time. Starts at 50% with a 25% damage gain per second. Upgrades increase max charge and charge rate by 25% per level. Rare uipgrade.

-Stronger Armor: Adds +5% to green armor protection value and +10% blue armor protection value per level. rare upgrade.

-Sneak Attack: Adds 50% damage when striking an unaware enemy. Damage increases by 12.5% per level, caps at level 4. Rare upgrade.

Also, is there any way one could add overrides to the upgrade list for specific weapons? In case a certain weapon just ends up being TOO good with certain upgrades? (Looking at the MetaDoom EKG pistol, which is way too easy to make overpowered for a basic pistol, give this thing some piercing, fragmentation, and submunitions and becomes way too beastly for a low end gun)

Anyway, regardless of if these ideas have any merit and end up being something you can use, I'm looking forward to seeing where this mod goes! :)

### Someday

- investigate use of A_SetTics() instead of freeze powerup for Swiftness
- investigate embrittlement instakill proccing earlier than it should; observed offing a 3000hp enemy at 1300hp
  - might be working as intended
- thunderbolt should be easier to trigger? Alex can't trigger it at all with one level and a pistol against a pinky


### Eventually?

- per-state overrides in BONSAIRC, e.g. "if the weapon is in this state, treat it as this other weapon instead"
- allow per-state overrides to create virtual weapons for cases where there is no underlying real weapon, like the Ashes boot knife
- allow tracking primary and alt fire separately, probably using state overrides to tell it which states count as which


### Later

- BONSAIRC support for binding specific weapon *states* to other weapons?
- general purpose pluggable XP sources for e.g. currency in mods that have it?

Remaining upgrades:
- Ignition
- max health increase
- Shoryuken
- explosive fragmentation
- micromissiles -- projectiles turn into micromissile swarms after a few tics of flight. How do we compute damage?

Gameplay changes:
- do another pass over the prerequisites. Graph paper? submunitions/expldeath should mutex, for example
- add "eat weapons to gain their power" feature to LD integration

Internal changes:
- factor out some shared code like "spawn a helper actor and set its target pointer appropriately", "spawn an expanding ring of particle effects", "do something to everything within a given radius", etc.

UI changes:
- Pointing at an enemy should show you how many stacks of each debuff it has. We can
  use AimTarget to get the target under cursor. Note that AimTarget is play scope, so
  we can't call it from ui, I think.

Structural changes:
- split Laevis (legendoom integration) & Gun Bonsai (weapon leveling) into separate mods

## Splitting Laevis into its own mod

Laevis features:
- eat LD weapons to add their powers to your own weapon
- switch between powers

Gun Bonsai features:
- leveling up LD weapons adds new powers

## Damage numbers

http://www.doom2.net/single/weaponfaq.html has some useful values for attack rates, DPS, etc that can be used for balancing.

DPS: 22/88, 25, 68/147, 88, 159+220, 263
RPM: 120/480, 150, 58/42, 530, 106, 700

I really need to implement softcap support!

20% damage -> stacks with 35 stacks/second decay == 175 dps for steady state
5 stacks/second decay (using TickDot()) -> 25 dps for steady state
## Player-level upgrades

- max health
- life/armour regeneration out of combat?

## Weapon-level upgrades

These all have to be possible without subclassing, so this is kind of spitballing; some of these may not be feasible to implement.
I think that we have access to the projectile at creation time (via WorldThingSpawned) and the projectile/puff at damage time (via ModifyDamage and/or WorldThingDamaged).

Basic "number go up" upgrades:
- knockback
  weapon kickback & projectilekickback property
  will need some tuning (a value of 500 gives noticeable but not excessive kickback to the pistol)
  needs to be applied before the gun fires, so we need some kind of ApplyUpgradesToWeapon(wpn)
  call we can call after LevelUp

More complicated upgrades:
- AoE stun
  Use A_Explode and then have a custom damage handler? Spawn some kind of explosion actor?
- submunitions in flight
  Spawn() or use A_ThrowGrenade(), needs custom class definition for submunition
- submunitions on impact
  as above
- turns enemies into friends
  set FRIENDLY flag when damage threshold reached or w/e

Upgrades inspired by DoomRL:
- increase max health
- increased speed
- berserk after successful hits/kills
- show secrets/monsters/items/etc on map
- damage type modifications (e.g. shrapnel -> AP)
- damage resistance while firing
